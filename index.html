<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <link rel="icon" href="/favicon.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EduEval Platform</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/src/style.css" />
</head>
<body class="text-gray-800 h-screen flex flex-col overflow-hidden">
  <div id="app">
    <header class="bg-indigo-600 text-white shadow-lg z-10">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <i class="fas fa-graduation-cap text-2xl"></i>
                <h1 class="text-xl font-bold tracking-wide">EduEval Platform</h1>
            </div>
            <div id="userInfo" class="hidden flex items-center gap-4">
                <span id="welcomeText" class="font-medium"></span>
                <button onclick="logout()" class="bg-indigo-700 hover:bg-indigo-800 px-3 py-1 rounded text-sm transition">
                    Logout
                </button>
            </div>
        </div>
    </header> 

    <main id="app" class="flex-1 overflow-y-auto p-4 relative">
        
        <!-- LOGIN / LANDING SCREEN -->
        <div id="view-login" class="max-w-md mx-auto mt-10 bg-white p-8 rounded-lg shadow-md fade-in">
            <h2 class="text-2xl font-bold mb-6 text-center text-indigo-600">Welcome Back</h2>
            <div class="space-y-4">
                <input type="text" id="loginName" placeholder="Name" class="w-full p-3 border rounded focus:outline-none focus:border-indigo-500">
                <input type="password" id="loginPass" placeholder="Password" class="w-full p-3 border rounded focus:outline-none focus:border-indigo-500">
                <button onclick="login()" class="w-full bg-indigo-600 text-white py-3 rounded hover:bg-indigo-700 font-bold transition">Login</button>
            </div>
            <div class="mt-6 text-center text-sm text-gray-600">
                <p>New here?</p>
                <div class="flex justify-center gap-4 mt-2">
                    <button onclick="showView('view-signup-teacher')" class="text-indigo-600 hover:underline">Signup as Teacher</button>
                    <span>|</span>
                    <button onclick="showView('view-signup-student')" class="text-indigo-600 hover:underline">Signup as Student</button>
                </div>
            </div>
        </div>

        <!-- SIGNUP TEACHER -->
        <div id="view-signup-teacher" class="hidden max-w-lg mx-auto mt-6 bg-white p-8 rounded-lg shadow-md fade-in">
            <h2 class="text-2xl font-bold mb-4 text-indigo-600">Teacher Registration</h2>
            <div class="space-y-3">
                <input id="tName" type="text" placeholder="Name" class="w-full p-2 border rounded">
                <input id="tPass" type="password" placeholder="Password" class="w-full p-2 border rounded">
                <input id="tSubj" type="text" placeholder="Subject" class="w-full p-2 border rounded">
                <input id="tCode" type="text" placeholder="Course Code (e.g. CSE101)" class="w-full p-2 border rounded">
                <input id="tContact" type="text" placeholder="Contact Number" class="w-full p-2 border rounded">
                <input id="tAvail" type="text" placeholder="Availability" class="w-full p-2 border rounded">
                <div class="flex gap-2 pt-4">
                    <button onclick="showView('view-login')" class="flex-1 bg-gray-200 py-2 rounded">Cancel</button>
                    <button onclick="signupTeacher()" class="flex-1 bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700">Register</button>
                </div>
            </div>
        </div>

        <!-- SIGNUP STUDENT -->
        <div id="view-signup-student" class="hidden max-w-lg mx-auto mt-6 bg-white p-8 rounded-lg shadow-md fade-in">
            <h2 class="text-2xl font-bold mb-4 text-indigo-600">Student Registration</h2>
            <div class="space-y-3 h-96 overflow-y-auto pr-2">
                <input id="sName" type="text" placeholder="Name" class="w-full p-2 border rounded">
                <input id="sPass" type="password" placeholder="Password" class="w-full p-2 border rounded">
                <input id="sId" type="text" placeholder="University ID (e.g. 242-15-479)" class="w-full p-2 border rounded">
                <input id="sNo" type="text" placeholder="Contact No" class="w-full p-2 border rounded">
                <input id="sBatch" type="text" placeholder="Batch No" class="w-full p-2 border rounded">
                <div class="bg-gray-50 p-3 rounded text-sm">
                    <p class="mb-2 font-semibold">Previous CGPAs (comma separated)</p>
                    <input id="sCgpa" type="text" placeholder="e.g. 3.5, 3.8, 4.0" class="w-full p-2 border rounded">
                </div>
                <input id="sSkills" type="text" placeholder="Skills (comma separated)" class="w-full p-2 border rounded">
                <input id="sLinks" type="text" placeholder="Links (comma separated)" class="w-full p-2 border rounded">
            </div>
            <div class="flex gap-2 pt-4">
                <button onclick="showView('view-login')" class="flex-1 bg-gray-200 py-2 rounded">Cancel</button>
                <button onclick="signupStudent()" class="flex-1 bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700">Register</button>
            </div>
        </div>

        <!-- TEACHER DASHBOARD -->
        <div id="view-teacher-dash" class="hidden container mx-auto fade-in">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <!-- Sidebar -->
                <div class="md:col-span-1 bg-white p-4 rounded-lg shadow h-fit">
                    <div class="text-center mb-6">
                        <div class="w-20 h-20 bg-indigo-100 rounded-full flex items-center justify-center mx-auto text-indigo-600 text-2xl font-bold mb-2">
                            <span id="teacherInitialsDisplay">T</span>
                        </div>
                        <h3 id="teacherNameDisplay" class="font-bold text-lg">Teacher Name</h3>
                        <p id="teacherCodeDisplay" class="text-sm text-gray-500">Code</p>
                    </div>
                    <nav class="space-y-2">
                        <button onclick="switchTab('t-profile')" class="w-full text-left p-2 hover:bg-indigo-50 rounded t-tab active-tab" data-tab="t-profile"><i class="fas fa-user mr-2"></i> Profile</button>
                        <button onclick="switchTab('t-search')" class="w-full text-left p-2 hover:bg-indigo-50 rounded t-tab" data-tab="t-search"><i class="fas fa-search mr-2"></i> Search Student</button>
                        <button onclick="switchTab('t-eval')" class="w-full text-left p-2 hover:bg-indigo-50 rounded t-tab" data-tab="t-eval"><i class="fas fa-star mr-2"></i> Evaluate Student</button>
                        <button onclick="switchTab('t-problems')" class="w-full text-left p-2 hover:bg-indigo-50 rounded t-tab" data-tab="t-problems"><i class="fas fa-question-circle mr-2"></i> Problems</button>
                        <button onclick="switchTab('t-leaderboard')" class="w-full text-left p-2 hover:bg-indigo-50 rounded t-tab" data-tab="t-leaderboard"><i class="fas fa-trophy mr-2"></i> Leaderboards</button>
                        <button onclick="switchTab('t-extracare')" class="w-full text-left p-2 hover:bg-indigo-50 rounded t-tab" data-tab="t-extracare"><i class="fas fa-heart mr-2"></i> Extra Care List</button>
                    </nav>
                </div>

                <!-- Content -->
                <div class="md:col-span-3">
                    <!-- Profile Tab -->
                    <div id="t-profile" class="tab-content bg-white p-6 rounded-lg shadow">
                        <div class="flex justify-between items-center mb-4 border-b pb-2">
                            <h2 class="text-xl font-bold">My Profile</h2>
                            <button onclick="enableEditMode('teacher')" class="text-sm bg-gray-200 hover:bg-gray-300 px-3 py-1 rounded"><i class="fas fa-edit"></i> Edit</button>
                        </div>
                        
                        <!-- View Mode -->
                        <div id="teacherProfileView" class="space-y-2 text-gray-700"></div>

                        <!-- Edit Mode -->
                        <div id="teacherProfileEdit" class="hidden space-y-4">
                            <div class="p-4 bg-yellow-50 rounded text-sm text-yellow-700 mb-2">
                                Note: Name and Course Code cannot be changed.
                            </div>
                            <div>
                                <label class="block text-sm font-medium">Subject</label>
                                <input id="editTSubject" type="text" class="w-full p-2 border rounded">
                            </div>
                            <div>
                                <label class="block text-sm font-medium">Contact Number</label>
                                <input id="editTContact" type="text" class="w-full p-2 border rounded">
                            </div>
                            <div>
                                <label class="block text-sm font-medium">Availability</label>
                                <input id="editTAvail" type="text" class="w-full p-2 border rounded">
                            </div>
                            <div class="pt-4 border-t">
                                <h3 class="font-bold mb-2">Change Password</h3>
                                <input id="editTPass" type="password" placeholder="New Password (leave blank to keep current)" class="w-full p-2 border rounded">
                            </div>
                            <div class="flex gap-2">
                                <button onclick="saveProfile('teacher')" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700">Save Changes</button>
                                <button onclick="cancelEdit('teacher')" class="bg-gray-300 px-4 py-2 rounded hover:bg-gray-400">Cancel</button>
                            </div>
                        </div>
                    </div>

                    <!-- Search Student Tab -->
                    <div id="t-search" class="tab-content hidden bg-white p-6 rounded-lg shadow">
                        <h2 class="text-xl font-bold mb-4 border-b pb-2">Search Student</h2>
                        <div class="flex gap-2 mb-6">
                            <input id="searchStudentId" type="text" placeholder="Enter Student University ID" class="p-2 border rounded flex-1">
                            <button onclick="searchStudent()" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700"><i class="fas fa-search"></i> Search</button>
                        </div>
                        <div id="student searchResult"></div>
                    </div>

                    <!-- Evaluation Tab -->
                    <div id="t-eval" class="tab-content hidden bg-white p-6 rounded-lg shadow">
                        <h2 class="text-xl font-bold mb-4 border-b pb-2">Evaluate Student</h2>
                        <div class="space-y-4 max-w-lg">
                            <div>
                                <label class="block text-sm font-medium">Student University ID</label>
                                <input id="evalId" type="text" class="w-full p-2 border rounded mt-1">
                            </div>
                            <div>
                                <label class="block text-sm font-medium">Course</label>
                                <input id="evalCourse" type="text" class="w-full p-2 border rounded mt-1">
                            </div>
                            <div>
                                <label class="block text-sm font-medium">Stars (1-5)</label>
                                <select id="evalStars" class="w-full p-2 border rounded mt-1">
                                    <option value="5">5 Stars</option>
                                    <option value="4">4 Stars</option>
                                    <option value="3">3 Stars</option>
                                    <option value="2">2 Stars</option>
                                    <option value="1">1 Star</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium">Comment</label>
                                <textarea id="evalComment" class="w-full p-2 border rounded mt-1" rows="3"></textarea>
                            </div>
                            <button onclick="submitEvaluation()" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700">Submit Evaluation</button>
                        </div>
                    </div>

                    <!-- Problems Tab -->
                    <div id="t-problems" class="tab-content hidden space-y-4">
                        <div class="bg-white p-4 rounded-lg shadow flex justify-between items-center">
                            <h2 class="text-xl font-bold">Problem Feed</h2>
                            <button onclick="renderProblems('teacher')" class="text-sm text-indigo-600"><i class="fas fa-sync"></i> Refresh</button>
                        </div>
                        <div id="teacherProblemList" class="space-y-4"></div>
                    </div>

                    <!-- Leaderboard Tab -->
                    <div id="t-leaderboard" class="tab-content hidden bg-white p-6 rounded-lg shadow"> 
                        <div class="flex gap-4 mb-4">
                            <button onclick="renderLeaderboard('student')" class="bg-indigo-100 text-indigo-800 px-3 py-1 rounded hover:bg-indigo-200">Student Rankings</button>
                            <button onclick="renderLeaderboard('teacher')" class="bg-indigo-100 text-indigo-800 px-3 py-1 rounded hover:bg-indigo-200">Teacher Rankings</button>
                        </div>
                        <div id="leaderboardContent" class="overflow-x-auto"></div>
                    </div>

                    <!-- Extra Care Tab -->
                    <div id="t-extracare" class="tab-content hidden bg-white p-6 rounded-lg shadow">
                        <h2 class="text-xl font-bold mb-4 border-b pb-2">Extra Care Management</h2>
                        <div class="flex gap-2 mb-6">
                            <input id="extraCareId" type="text" placeholder="Student ID to Add" class="p-2 border rounded flex-1">
                            <button onclick="addToExtraCare()" class="bg-pink-600 text-white px-4 py-2 rounded hover:bg-pink-700">Add to List</button>
                        </div>
                        <h3 class="font-bold mb-2 text-gray-600">Current List:</h3>
                        <div id="extraCareList" class="space-y-2"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- STUDENT DASHBOARD -->
        <div id="view-student-dash" class="hidden container mx-auto fade-in"> 
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <!-- Sidebar -->
                <div class="md:col-span-1 bg-white p-4 rounded-lg shadow h-fit">
                    <div class="text-center mb-6">
                        <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto text-green-600 text-2xl font-bold mb-2">
                            <i class="fas fa-user-graduate"></i>
                        </div>
                        <h3 id="studentNameDisplay" class="font-bold text-lg">Student Name</h3>
                        <p id="studentIdDisplay" class="text-sm text-gray-500">ID</p>
                    </div>
                    <nav class="space-y-2">
                        <button onclick="switchTab('s-profile')" class="w-full text-left p-2 hover:bg-green-50 rounded s-tab active-tab" data-tab="s-profile"><i class="fas fa-user mr-2"></i> Profile</button>
                        <button onclick="switchTab('s-search')" class="w-full text-left p-2 hover:bg-green-50 rounded s-tab" data-tab="s-search"><i class="fas fa-search mr-2"></i> Search Teacher</button>
                        <button onclick="switchTab('s-search-student')" class="w-full text-left p-2 hover:bg-green-50 rounded s-tab" data-tab="s-search-student"><i class="fas fa-user-friends mr-2"></i> Search Student</button>
                        <button onclick="switchTab('s-submit')" class="w-full text-left p-2 hover:bg-green-50 rounded s-tab" data-tab="s-submit"><i class="fas fa-pen mr-2"></i> Submit Problem</button>
                        <button onclick="switchTab('s-problems')" class="w-full text-left p-2 hover:bg-green-50 rounded s-tab" data-tab="s-problems"><i class="fas fa-list mr-2"></i> View Problems</button>
                        <button onclick="switchTab('s-leaderboard')" class="w-full text-left p-2 hover:bg-green-50 rounded s-tab" data-tab="s-leaderboard"><i class="fas fa-trophy mr-2"></i> Batch Leaderboard</button>
                    </nav>
                </div>

                <!-- Content -->
                <div class="md:col-span-3">
                    <!-- Profile Tab -->
                    <div id="s-profile" class="tab-content bg-white p-6 rounded-lg shadow"> 
                        <div class="flex justify-between items-center mb-4 border-b pb-2">
                            <h2 class="text-xl font-bold">My Profile</h2>
                            <button onclick="enableEditMode('student')" class="text-sm bg-gray-200 hover:bg-gray-300 px-3 py-1 rounded"><i class="fas fa-edit"></i> Edit</button>
                        </div>
                        
                        <!-- View Mode -->
                        <div id="studentProfileView" class="space-y-2 text-gray-700"></div>

                        <!-- Edit Mode -->
                        <div id="studentProfileEdit" class="hidden space-y-4">
                            <div class="p-4 bg-yellow-50 rounded text-sm text-yellow-700 mb-2">
                                Note: Name, ID, and Batch cannot be changed.
                            </div>
                            <div>
                                <label class="block text-sm font-medium">Contact Number</label>
                                <input id="editSContact" type="text" class="w-full p-2 border rounded">
                            </div>
                            <div>
                                <label class="block text-sm font-medium">Skills (comma separated)</label>
                                <input id="editSSkills" type="text" class="w-full p-2 border rounded">
                            </div>
                            <div>
                                <label class="block text-sm font-medium">Links (comma separated)</label>
                                <input id="editSLinks" type="text" class="w-full p-2 border rounded">
                            </div>
                            <div class="pt-4 border-t">
                                <h3 class="font-bold mb-2">Change Password</h3>
                                <input id="editSPass" type="password" placeholder="New Password (leave blank to keep current)" class="w-full p-2 border rounded">
                            </div>
                            <div class="flex gap-2">
                                <button onclick="saveProfile('student')" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700">Save Changes</button>
                                <button onclick="cancelEdit('student')" class="bg-gray-300 px-4 py-2 rounded hover:bg-gray-400">Cancel</button>
                            </div>
                        </div>

                        <h3 class="font-bold mt-6 mb-2 border-b pb-1">Evaluations</h3>
                        <div id="studentEvaluationsList" class="space-y-3"></div>
                    </div>

                    <!-- Search Teacher Tab -->
                    <div id="s-search" class="tab-content hidden bg-white p-6 rounded-lg shadow">
                        <h2 class="text-xl font-bold mb-4 border-b pb-2">Search Teacher</h2>
                        <div class="flex gap-2 mb-6">
                            <input id="searchTeacherName" type="text" placeholder="Enter Teacher Name" class="p-2 border rounded flex-1">
                            <button onclick="searchTeacher()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"><i class="fas fa-search"></i> Search</button>
                        </div>
                        <div id="teacherSearchResult"></div>
                    </div>

                    <!-- Search Student Tab (Student View) -->
                    <div id="s-search-student" class="tab-content hidden bg-white p-6 rounded-lg shadow">
                        <h2 class="text-xl font-bold mb-4 border-b pb-2">Search Student</h2>
                        <div class="flex gap-2 mb-6">
                            <input id="searchPeerId" type="text" placeholder="Enter Student University ID" class="p-2 border rounded flex-1">
                            <button onclick="searchPeer()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"><i class="fas fa-search"></i> Search</button>
                        </div>
                        <div id="peerSearchResult"></div>
                    </div>

                    <!-- Submit Problem Tab -->
                    <div id="s-submit" class="tab-content hidden bg-white p-6 rounded-lg shadow"> 
                        <h2 class="text-xl font-bold mb-4 border-b pb-2">Submit New Problem</h2>
                        <div class="space-y-4">
                            <input id="probCourse" type="text" placeholder="Course Name" class="w-full p-2 border rounded">
                            <textarea id="probDesc" placeholder="Describe your problem in detail..." class="w-full p-2 border rounded" rows="4"></textarea>
                            <button onclick="submitProblem()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Post Problem</button>
                        </div>
                    </div>

                    <!-- Problems Tab -->
                    <div id="s-problems" class="tab-content hidden space-y-4">
                        <div class="bg-white p-4 rounded-lg shadow flex justify-between items-center">
                            <h2 class="text-xl font-bold">Global Problems</h2>
                            <button onclick="renderProblems('student')" class="text-sm text-green-600"><i class="fas fa-sync"></i> Refresh</button>
                        </div>
                        <div id="studentProblemList" class="space-y-4"></div>
                    </div>

                    <!-- Leaderboard Tab -->
                    <div id="s-leaderboard" class="tab-content hidden bg-white p-6 rounded-lg shadow">
                        <h2 class="text-xl font-bold mb-4 border-b pb-2">My Batch Leaderboard</h2>
                        <div id="studentBatchLeaderboard"></div>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <!-- Your FULL original HTML from <header> to </main> goes here -->
    <!-- Copy-paste everything inside your old <body> except the <script> -->
    <!-- I put the clean version below -->
  </div>

  <div id="toast" class="fixed bottom-4 right-4 bg-gray-800 text-white px-6 py-3 rounded shadow-lg transform translate-y-20 transition-transform duration-300 z-50">
    Notification
  </div>

  <script type="module" src="/src/main.js"></script>
</body>
</html>